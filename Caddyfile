:80 {
	encode gzip

	# Reverse proxy for API
	handle /api/* {
		reverse_proxy manager:8080
	}

	# Serve SPA
	handle {
		root * /app/dist
		try_files {path} /index.html
		file_server
	}

	# Static files caching
	@static {
		path /assets/*
		path *.js
		path *.css
	}
	header @static Cache-Control "public, max-age=31536000, immutable"

	# HTML caching
	@html {
		path *.html
	}
	header @html Cache-Control "public, max-age=3600, must-revalidate"

	# Disable caching for index.html
	@index {
		path /index.html
	}
	header @index Cache-Control "no-cache, no-store, must-revalidate"
}
